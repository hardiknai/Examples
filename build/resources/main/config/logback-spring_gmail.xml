<?xml version="1.0" encoding="UTF-8"?>
<configuration>

	<springProperty scope="context" name="logging.location"
		source="server.tomcat.accesslog.directory" />
	
	<appender name="FILE"
		class="ch.qos.logback.core.rolling.RollingFileAppender">
		<file>${logging.location}\firstai.log</file>
		<rollingPolicy
			class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
			<!-- rollover daily -->
			<fileNamePattern>${logging.location}\firstai-%d{dd-MM-yyyy}.%i.log
			</fileNamePattern>
			<!-- each file should be at most 100MB, keep 60 days worth of history, 
				but at most 20GB -->
			<maxFileSize>512KB</maxFileSize>
			<maxHistory>3</maxHistory>
			<totalSizeCap>1GB</totalSizeCap>
		</rollingPolicy>
		<encoder>
			<pattern>%d %thread %-5level %logger{36} %M - %msg %n</pattern>
		</encoder>
	</appender>

	<springProfile name="stage">
		<root level="WARN">
			<appender-ref ref="FILE" />
		</root>
	</springProfile>

	<appender name="EMAIL" class="ch.qos.logback.classic.net.SMTPAppender">

		<smtpHost>smtp.gmail.com</smtpHost>
		<smtpPort>587</smtpPort>
		<STARTTLS>true</STARTTLS>
		<username>shilpa.nai876@gmail.com</username>
		<password>Shilpa@123</password>
		<to>hardik@firstai.co</to>
		<from>shilpa.nai876@gmail.com</from>
		<subject>Exception: %logger{20} - %m</subject>
		<layout class="ch.qos.logback.classic.html.HTMLLayout" />
		<cyclicBufferTracker class="ch.qos.logback.core.spi.CyclicBufferTracker">
			<!-- send just one log entry per email -->
			<bufferSize>1</bufferSize>
		</cyclicBufferTracker>
		<layout class="ch.qos.logback.classic.html.HTMLLayout" />
	</appender>



	<springProfile name="prod">
		<root level="error">
			<appender-ref ref="EMAIL" />
		</root>
	</springProfile>
</configuration>