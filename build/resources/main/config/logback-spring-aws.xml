<?xml version="1.0" encoding="UTF-8"?>
<configuration>

	<springProperty scope="context" name="smtpHost" source="spring.mail.host" />
	<springProperty scope="context" name="smtpPort"
		source="spring.mail.properties.mail.smtp.port" />
	<springProperty scope="context" name="STARTTLS"
		source="spring.mail.properties.mail.smtp.starttls.enable" />
	<springProperty scope="context" name="username"
		source="spring.mail.username" />
	<springProperty scope="context" name="password"
		source="spring.mail.password" />

	<appender name="EMAIL" class="ch.qos.logback.classic.net.SMTPAppender">

		<smtpHost>${smtpHost}</smtpHost>
		<smtpPort>${smtpPort}</smtpPort>
		<STARTTLS>${STARTTLS}</STARTTLS>
		<username>${username}</username>
		<password>${password}</password>
		<to>hardik@firstai.co</to>
		<from>${username}</from>
		<subject>Exception: %logger{20} - %m</subject>

		<discriminator class="ch.qos.logback.classic.sift.MDCBasedDiscriminator">
			<key>AKIAJJS6YM2EE4L5WFZQ</key>
			<defaultValue>RsY0jHPNwiBX3xorRpaEHBqCyY0AuiivJuUM2Lw5</defaultValue>
		</discriminator>


		<cyclicBufferTracker class="ch.qos.logback.core.spi.CyclicBufferTracker">
			<!-- send just one log entry per email -->
			<bufferSize>1</bufferSize>
		</cyclicBufferTracker>
		<layout class="ch.qos.logback.classic.html.HTMLLayout" />
	</appender>

	<springProfile name="prod">
		<root level="INFO">
			<appender-ref ref="EMAIL" />
		</root>
	</springProfile>
</configuration>